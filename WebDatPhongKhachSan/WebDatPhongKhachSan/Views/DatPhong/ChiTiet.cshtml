@model WebDatPhongKhachSan.Models.BookingRowVM
@{
    ViewBag.Title = "Chi tiết đặt phòng";
    Layout = "~/Views/Shared/LayoutPage.cshtml";
}

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />

<style>
    .page-title {
        font-weight: 950;
        letter-spacing: -.2px;
        color: #0b4ab8;
    }

    .cardx {
        background: #fff;
        border: 1px solid rgba(2,8,23,.08);
        border-radius: 18px;
        box-shadow: 0 14px 34px rgba(2,8,23,.08);
        overflow: hidden;
    }

    .cardx-header {
        padding: 14px 16px;
        background: linear-gradient(135deg, rgba(0,113,194,.10), rgba(11,132,227,.06));
        border-bottom: 1px solid rgba(2,8,23,.08);
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 10px;
        flex-wrap: wrap;
    }

    .chip {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 6px 10px;
        border-radius: 999px;
        border: 1px solid rgba(2,8,23,.10);
        background: rgba(2,8,23,.02);
        font-weight: 900;
        font-size: .82rem;
        color: #0f172a;
        white-space: nowrap;
    }

    .muted {
        color: #64748b;
    }

    .mono {
        font-variant-numeric: tabular-nums;
    }

    .badge-status {
        border-radius: 999px;
        padding: .35rem .6rem;
        font-weight: 900;
        letter-spacing: .2px;
        border: 1px solid transparent;
        display: inline-flex;
        align-items: center;
        gap: 6px;
    }

    .badge-hold {
        background: rgba(59,130,246,.12);
        color: #1d4ed8;
        border-color: rgba(29,78,216,.25);
    }

    .badge-ok {
        background: rgba(16,185,129,.14);
        color: #047857;
        border-color: rgba(4,120,87,.25);
    }

    .badge-cancel {
        background: rgba(239,68,68,.12);
        color: #b91c1c;
        border-color: rgba(185,28,28,.25);
    }

    .badge-warn {
        background: rgba(245,158,11,.14);
        color: #92400e;
        border-color: rgba(146,64,14,.25);
    }

    .iconbox {
        width: 40px;
        height: 40px;
        border-radius: 14px;
        display: grid;
        place-items: center;
        background: rgba(0,113,194,.10);
        color: #0b4ab8;
        border: 1px solid rgba(0,113,194,.16);
    }

    .kv .k {
        color: #64748b;
        font-weight: 800;
    }

    .kv .v {
        font-weight: 900;
        color: #0f172a;
    }

    .money {
        font-weight: 950;
        color: #dc2626;
    }

    .btn-soft {
        border-radius: 14px;
        font-weight: 900;
        padding: .7rem 1rem;
        background: rgba(2,8,23,.03);
        border: 1px solid rgba(2,8,23,.10);
        color: #0f172a;
    }

        .btn-soft:hover {
            filter: brightness(1.02);
            transform: translateY(-1px);
        }
</style>

@{
    // Badge theo trạng thái
    var stRaw = (Model.TrangThai ?? "").ToLower();
    var badgeClass = "badge-warn";
    if (stRaw.Contains("giữ") || stRaw.Contains("chờ") || stRaw.Contains("xác nhận")) { badgeClass = "badge-hold"; }
    if (stRaw.Contains("thành công") || stRaw.Contains("hoàn tất") || stRaw.Contains("đã nhận") || stRaw.Contains("check")) { badgeClass = "badge-ok"; }
    if (stRaw.Contains("hủy") || stRaw.Contains("huỷ")) { badgeClass = "badge-cancel"; }
}

<div class="container py-4">

    <!-- Header -->
    <div class="d-flex align-items-start justify-content-between flex-wrap gap-2 mb-3">
        <div class="d-flex align-items-center gap-2">
            <div class="iconbox"><i class="fa-solid fa-receipt"></i></div>
            <div>
                <div class="page-title h4 mb-0">Chi tiết đặt phòng</div>
                <div class="muted small">Mã đặt: <span class="mono fw-bold">#@Model.MaDatPhong</span></div>
            </div>
        </div>

        <div class="d-flex align-items-center gap-2 flex-wrap">
            <span class="badge-status @badgeClass">
                <i class="fa-solid fa-circle-info"></i>@Model.TrangThai
            </span>

            <span class="chip">
                <i class="fa-regular fa-moon"></i>
                <span class="mono">@Model.SoDem</span> đêm
            </span>

            <a class="btn btn-soft" href="@Url.Action("Index","DatPhong")">
                <i class="fa-solid fa-arrow-left me-1"></i>Quay lại
            </a>
        </div>
    </div>

    <div class="row g-3">

        <!-- Thông tin khách -->
        <div class="col-lg-6">
            <div class="cardx">
                <div class="cardx-header">
                    <div class="fw-bold">
                        <i class="fa-solid fa-user me-1"></i> Thông tin khách
                    </div>
                    <span class="chip">
                        <i class="fa-solid fa-id-card"></i>
                        @((string.IsNullOrWhiteSpace(Model.CCCD) ? "—" : Model.CCCD))
                    </span>
                </div>

                <div class="p-3">
                    <div class="row g-2 kv">
                        <div class="col-12">
                            <div class="k">Họ tên</div>
                            <div class="v">@((string.IsNullOrWhiteSpace(Model.HoTen) ? "—" : Model.HoTen))</div>
                        </div>

                        <div class="col-md-6">
                            <div class="k">Số điện thoại</div>
                            <div class="v mono">@((string.IsNullOrWhiteSpace(Model.SoDienThoai) ? "—" : Model.SoDienThoai))</div>
                        </div>

                        <div class="col-md-6">
                            <div class="k">Email</div>
                            <div class="v">@((string.IsNullOrWhiteSpace(Model.Email) ? "—" : Model.Email))</div>
                        </div>

                        <div class="col-md-6">
                            <div class="k">Quốc tịch</div>
                            <div class="v">@((string.IsNullOrWhiteSpace(Model.QuocTich) ? "—" : Model.QuocTich))</div>
                        </div>

                        <div class="col-md-6">
                            <div class="k">Giới tính</div>
                            <div class="v">@((string.IsNullOrWhiteSpace(Model.GioiTinh) ? "—" : Model.GioiTinh))</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Thông tin đặt phòng -->
        <div class="col-lg-6">
            <div class="cardx">
                <div class="cardx-header">
                    <div class="fw-bold">
                        <i class="fa-solid fa-calendar-check me-1"></i> Thông tin đặt phòng
                    </div>
                    <span class="chip">
                        <i class="fa-regular fa-clock"></i>
                        @Model.NgayDat.ToString("dd/MM/yyyy HH:mm")
                    </span>
                </div>

                <div class="p-3">
                    <div class="row g-2 kv">
                        <div class="col-12">
                            <div class="k">Nhận / Trả</div>
                            <div class="v mono">
                                @Model.NgayNhan.ToString("dd/MM/yyyy") → @Model.NgayTra.ToString("dd/MM/yyyy")
                            </div>
                            <div class="muted small mt-1">
                                <i class="fa-regular fa-moon me-1"></i>@Model.SoDem đêm
                            </div>
                        </div>

                        <div class="col-12 mt-1">
                            <div class="k">Tổng tiền</div>
                            <div class="money mono">@String.Format("{0:N0} ₫", Model.TongTien)</div>
                        </div>

                        <div class="col-12 mt-1">
                            <div class="k">Ghi chú</div>
                            <div class="v" style="font-weight:800;">
                                @(!string.IsNullOrWhiteSpace(Model.GhiChu) ? Model.GhiChu : "—")
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <!-- Phòng / Khách sạn -->
        <div class="col-12">
            <div class="cardx">
                <div class="cardx-header">
                    <div class="fw-bold">
                        <i class="fa-solid fa-hotel me-1"></i> Phòng / Khách sạn
                    </div>

                    @if (Model.MaPhong.HasValue)
                    {
                        <span class="chip">
                            <i class="fa-solid fa-bed"></i>
                            @Model.TenPhong (Mã: <span class="mono">@Model.MaPhong</span>)
                        </span>
                    }
                    else
                    {
                        <span class="badge-status badge-warn">
                            <i class="fa-solid fa-hourglass-half"></i>Chưa xếp phòng
                        </span>
                    }
                </div>

                <div class="p-3">
                    <div class="row g-3">
                        <div class="col-lg-6">
                            <div class="p-3 rounded-4" style="background:rgba(2,8,23,.03); border:1px dashed rgba(2,8,23,.12);">
                                <div class="fw-bold mb-2"><i class="fa-solid fa-bed me-1"></i>Thông tin phòng</div>

                                @if (Model.MaPhong.HasValue)
                                {
                                    <div class="kv">
                                        <div class="k">Phòng</div>
                                        <div class="v">@Model.TenPhong <span class="muted">(Mã: <span class="mono">@Model.MaPhong</span>)</span></div>

                                        <div class="k mt-2">Trạng thái phòng</div>
                                        <div class="v">
                                            <span class="badge badge-status badge-hold">
                                                <i class="fa-solid fa-circle-dot"></i>@(string.IsNullOrWhiteSpace(Model.TrangThaiPhong) ? "—" : Model.TrangThaiPhong)
                                            </span>
                                        </div>

                                        <div class="k mt-2">Loại phòng</div>
                                        <div class="v">@((string.IsNullOrWhiteSpace(Model.TenLoai) ? "—" : Model.TenLoai))</div>

                                        <div class="k mt-2">Giá / đêm</div>
                                        <div class="v mono">@String.Format("{0:N0} ₫", Model.GiaCoBan)</div>

                                        <div class="k mt-2">Số người</div>
                                        <div class="v mono">@Model.SoNguoi</div>
                                    </div>
                                }
                                else
                                {
                                    <div class="muted">
                                        Đơn đặt phòng này hiện đang ở trạng thái <b>đặt theo loại phòng</b>.
                                        Khi lễ tân xếp phòng (gán MaPhong) thì thông tin phòng cụ thể sẽ hiển thị ở đây.
                                    </div>
                                }
                            </div>
                        </div>

                        <div class="col-lg-6">
                            <div class="p-3 rounded-4" style="background:rgba(0,113,194,.06); border:1px dashed rgba(0,113,194,.18);">
                                <div class="fw-bold mb-2"><i class="fa-solid fa-location-dot me-1"></i>Thông tin khách sạn</div>

                                <div class="kv">
                                    <div class="k">Tên khách sạn</div>
                                    <div class="v">@((string.IsNullOrWhiteSpace(Model.TenKS) ? "—" : Model.TenKS))</div>

                                    <div class="k mt-2">Địa chỉ</div>
                                    <div class="v">@((string.IsNullOrWhiteSpace(Model.DiaChiKS) ? "—" : Model.DiaChiKS))</div>

                                    <div class="k mt-2">Khu vực</div>
                                    <div class="v">@((string.IsNullOrWhiteSpace(Model.ThanhPho) ? "—" : Model.ThanhPho)) • @((string.IsNullOrWhiteSpace(Model.QuocGia) ? "—" : Model.QuocGia))</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mt-3 d-flex justify-content-end gap-2 flex-wrap">
                        <a class="btn btn-soft" href="@Url.Action("Index","DatPhong")">
                            <i class="fa-solid fa-list me-1"></i>Về danh sách
                        </a>
                        <a class="btn btn-soft" href="@Url.Action("TrangChu","Home")">
                            <i class="fa-solid fa-house me-1"></i>Trang chủ
                        </a>
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>
