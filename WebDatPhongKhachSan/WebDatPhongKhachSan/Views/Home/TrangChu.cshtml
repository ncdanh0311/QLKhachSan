@model List<WebDatPhongKhachSan.Models.KhachSanViewModel>

@{
    ViewBag.Title = "Trang Chủ";
    Layout = "~/Views/Shared/LayoutPage.cshtml";

    // Pool ảnh fake (ổn định – không bị lỗi)
    var imgPool = new[]
    {
        "https://images.unsplash.com/photo-1566073771259-6a8506099945?w=1200&q=80",
        "https://images.unsplash.com/photo-1542314831-068cd1dbfeeb?w=1200&q=80",
        "https://images.unsplash.com/photo-1582719478250-c89cae4dc85b?w=1200&q=80",
        "https://images.unsplash.com/photo-1439130490301-25e322d88054?w=1200&q=80",
        "https://images.unsplash.com/photo-1480714378408-67cf0d13bc1b?w=1200&q=80",
        "https://images.unsplash.com/photo-1596394516093-501ba68a0ba6?w=1200&q=80",
        "https://images.unsplash.com/photo-1560662105-57f8ad6ae2d1?w=1200&q=80"
    };
}

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />

<style>
    /* ===== GRID ===== */
    .ks-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill,minmax(340px,1fr));
        gap: 22px;
    }

    .ks-link {
        text-decoration: none;
        color: inherit;
        display: block;
        height: 100%;
    }

    /* ===== CARD ===== */
    .ks-card {
        height: 100%;
        display: flex;
        flex-direction: column;
        background: #fff;
        border-radius: 22px;
        overflow: hidden;
        border: 1px solid rgba(0,0,0,.08);
        box-shadow: 0 14px 34px rgba(0,0,0,.08);
        transition: .22s ease;
    }

        .ks-card:hover {
            transform: translateY(-6px);
            box-shadow: 0 22px 50px rgba(0,0,0,.14);
        }

    /* ===== IMAGE ===== */
    .ks-img {
        width: 100%;
        height: 260px; /* TO – DÀI – CÂN */
        object-fit: cover;
    }

    .ks-heart {
        position: absolute;
        top: 14px;
        right: 14px;
        width: 42px;
        height: 42px;
        border-radius: 50%;
        background: #fff;
        display: grid;
        place-items: center;
        box-shadow: 0 6px 14px rgba(0,0,0,.18);
        cursor: pointer;
        z-index: 3;
    }

    /* ===== BODY ===== */
    .ks-body {
        padding: 18px 18px 20px;
        display: flex;
        flex-direction: column;
        gap: 6px;
        flex: 1;
    }

    .ks-type {
        font-size: .9rem;
        color: #64748b;
        display: flex;
        align-items: center;
        gap: 6px;
    }

    .ks-badge {
        background: #e8f0ff;
        color: #0b4ab8;
        border-radius: 999px;
        padding: 3px 10px;
        font-size: .75rem;
        font-weight: 800;
    }

    .ks-title {
        font-size: 1.25rem;
        font-weight: 900;
        line-height: 1.25;
    }

    .ks-stars i {
        color: #f59e0b;
        font-size: .85rem;
    }

    .ks-location {
        color: #6b7280;
        font-size: .95rem;
    }

    /* ===== FOOTER ===== */
    .ks-footer {
        margin-top: auto;
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 10px;
        padding-top: 10px;
    }

    .ks-score {
        background: #003b95;
        color: #fff;
        font-weight: 900;
        padding: 6px 12px;
        border-radius: 10px;
        font-size: 1rem;
        min-width: 48px;
        text-align: center;
    }

    .ks-review {
        font-size: .95rem;
    }
</style>

<div class="container py-4">
    <h3 class="fw-bold mb-4">🏨 Khách sạn nổi bật</h3>

    <div class="ks-grid">
        @for (int i = 0; i < Model.Count; i++)
        {
            var ks = Model[i];

            // Fake UI data
            var img = imgPool[i % imgPool.Length] + "&sig=" + ks.MaKS;
            var starCount = 4 + (ks.MaKS % 2);     // 4–5 sao
            var rating = Math.Round(8.0 + (ks.MaKS % 10) * 0.1, 1);
            var reviews = 250 + (ks.MaKS % 800);
            var isGenius = ks.MaKS % 3 == 0;

<a href="@Url.Action("LoaiPhong", "Phong", new { maKS = ks.MaKS })"
   class="ks-link">

    <div class="ks-card">
        <div class="position-relative">
            <img src="@img" class="ks-img" alt="@ks.TenKS" />
            <div class="ks-heart" title="Yêu thích">
                <i class="fa-regular fa-heart"></i>
            </div>
        </div>

        <div class="ks-body">
            <div class="ks-type">
                Guesthouse
                @if (isGenius)
                {
                    <span class="ks-badge">
                        <i class="fa-solid fa-crown me-1"></i>Genius
                    </span>
                }
            </div>

            <div class="ks-title">@ks.TenKS</div>

            <div class="ks-stars">
                @for (int s = 0; s < starCount; s++)
                {
                    <i class="fa-solid fa-star"></i>
                }
            </div>

            <div class="ks-location">
                <i class="fa-solid fa-location-dot me-1"></i>
                @ks.ThanhPho, @ks.QuocGia
            </div>

            <div class="ks-footer">
                <div class="d-flex align-items-center gap-2">
                    <div class="ks-score">@rating</div>
                    <div class="ks-review">
                        <div class="fw-bold">Excellent</div>
                        <div class="text-secondary">@reviews đánh giá</div>
                    </div>
                </div>

                <span class="fw-bold text-primary">
                    Xem phòng →
                </span>
            </div>
        </div>
    </div>
</a>
        }
    </div>
</div>

<script>
    // Click tim KHÔNG chuyển trang
    document.querySelectorAll('.ks-heart').forEach(el => {
        el.addEventListener('click', function (e) {
            e.preventDefault();
            e.stopPropagation();
            const icon = el.querySelector('i');
            icon.classList.toggle('fa-regular');
            icon.classList.toggle('fa-solid');
        });
    });
</script>
